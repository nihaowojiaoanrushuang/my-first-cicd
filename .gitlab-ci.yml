stages:
  - build
  - deploy

build-image:
  stage: build
  image: docker:latest
  services:
    - docker:dind
  before_script:
    - docker login -u "$CI_REGISTRY_USER" -p "$CI_REGISTRY_PASSWORD" $CI_REGISTRY
  script:
    - echo "ğŸš€ å¼€å§‹æ„å»ºDockeré•œåƒ..."
    - docker build -t $CI_REGISTRY_IMAGE:$CI_COMMIT_SHORT_SHA .
    - docker push $CI_REGISTRY_IMAGE:$CI_COMMIT_SHORT_SHA
    - echo "âœ… é•œåƒæ„å»ºå®Œæˆï¼"

deploy-message:
  stage: deploy
  image: alpine:latest
  script:
    - echo "ğŸ‰ éƒ¨ç½²é˜¶æ®µï¼"
    - echo "å¦‚æœè¿™æ˜¯çœŸå®ç¯å¢ƒï¼Œç°åœ¨å°±ä¼šè‡ªåŠ¨éƒ¨ç½²åˆ°æœåŠ¡å™¨äº†"
    - echo "é•œåƒåœ°å€: $CI_REGISTRY_IMAGE:$CI_COMMIT_SHORT_SHA"
  only:
    - main
